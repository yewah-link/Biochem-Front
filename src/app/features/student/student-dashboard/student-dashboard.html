<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #sidenav class="sidenav" mode="over">
    <mat-nav-list>
      <a mat-list-item routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
      <a mat-list-item routerLink="/topics" routerLinkActive="active">Topics</a>
      <a mat-list-item routerLink="/tests" routerLinkActive="active">Tests</a>
      <a mat-list-item routerLink="/progress" routerLinkActive="active">Progress</a>
      <a mat-list-item routerLink="/about-us" routerLinkActive="active">About Us</a>
      <a mat-list-item (click)="logout()">Logout</a>
    </mat-nav-list>
  </mat-sidenav>

  <mat-toolbar class="navbar mat-elevation-z4">
    <!-- MOBILE SEARCH MODE -->
    <div class="mobile-search" [class.active]="mobileSearchActive">
      <input class="mobile-search-input" placeholder="Search..." />
      <button mat-button (click)="mobileSearchActive = false">Cancel</button>
    </div>

    <!-- DEFAULT NAVBAR -->
    <div class="normal-navbar" [class.hidden]="mobileSearchActive">
      <!-- Hamburger -->
      <button mat-icon-button class="menu-btn" (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>

      <!-- Brand -->
      <span class="brand">Biochem</span>

      <span class="spacer"></span>

      <!-- Mobile Search Icon -->
      <button mat-icon-button class="mobile-search-btn"
              (click)="mobileSearchActive = true">
        <mat-icon>search</mat-icon>
      </button>

      <!-- Desktop Search -->
      <div class="search-container">
        <input class="search-input" placeholder="Search" />
        <button mat-icon-button class="search-icon">
          <mat-icon>search</mat-icon>
        </button>
      </div>

      <!-- Nav Links - Student Logged In -->
      <div class="nav-links logged-in">
        <button mat-button routerLink="/about-us" routerLinkActive="active">About Us</button>
        <div class="user-section">
          <span class="welcome-text">Welcome, {{userName}}!</span>
          <button mat-icon-button [matMenuTriggerFor]="userMenu" class="profile-btn">
            <mat-icon>account_circle</mat-icon>
          </button>
          <mat-menu #userMenu="matMenu">
            <button mat-menu-item routerLink="/dashboard">
              <mat-icon>dashboard</mat-icon>
              Dashboard
            </button>
            <button mat-menu-item routerLink="/topics">
              <mat-icon>book</mat-icon>
              Topics
            </button>
            <button mat-menu-item routerLink="/tests">
              <mat-icon>quiz</mat-icon>
              Tests
            </button>
            <button mat-menu-item routerLink="/progress">
              <mat-icon>trending_up</mat-icon>
              Progress
            </button>
            <button mat-menu-item routerLink="/profile">
              <mat-icon>person</mat-icon>
              Profile
            </button>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              Logout
            </button>
          </mat-menu>
        </div>
      </div>
    </div>
  </mat-toolbar>

  <!-- CATEGORY BAR -->
  <div class="category-bar">
    <button class="scroll-btn" (click)="scrollCategories('left')">&#10094;</button>

    <div class="category-track" #categoryTrack>
      @for (category of categories; track category.id) {
        <button
          (click)="selectCategory(category)"
          [class.active]="selectedCategoryId === category.id">
          {{ category.name }}
        </button>
      }
    </div>

    <button class="scroll-btn" (click)="scrollCategories('right')">&#10095;</button>
  </div>

  <!-- VIDEO LIST SECTION -->
<div class="video-list">
  <h2 class="video-title">Videos</h2>

  <!-- If a video is selected, show player layout -->
  @if (selectedVideo) {
    <div class="video-content-layout">

      <!-- Main Video Player -->
      <div class="video-player-section">
        <video
          controls
          class="main-video"
          [src]="getVideoStreamUrl(selectedVideo)"
          [poster]="getVideoThumbnail(selectedVideo)">
          Your browser does not support the video tag.
        </video>
        <div class="current-video-info">
          <h3>{{ selectedVideo.description }}</h3>
        </div>
      </div>

      <!-- Sidebar Recommendations -->
      <div class="recommended-videos">
        <h4>Up Next</h4>
        <div class="video-grid sidebar-list">
          @for (video of videos; track video.id) {
            <div class="video-card" (click)="selectVideo(video)">
              <img
                [src]="videoService.getVideoThumbnail(video) || videoService.getFallbackThumbnailUrl()"
                alt="Thumbnail"
                class="thumbnail"/>
              <div class="video-info">
                <p class="video-description">{{ video.description }}</p>
              </div>
            </div>
          }
        </div>
      </div>

    </div>
  }

  <!-- Otherwise, show simple grid layout -->
  @else {
    <div class="video-grid default-grid">
      @for (video of videos; track video.id) {
        <div class="video-card" (click)="selectVideo(video)">
          <img
            [src]="videoService.getVideoThumbnail(video) || videoService.getFallbackThumbnailUrl()"
            alt="Thumbnail"
            class="thumbnail"/>
          <div class="video-info">
            <p class="video-description">{{ video.description }}</p>
          </div>
        </div>
      }
    </div>
  }

  <!-- Empty Fallback -->
  @if (videos.length === 0) {
    <div class="empty-state">
      <p>No videos available in this category yet.</p>
    </div>
  }
</div>



</mat-sidenav-container>
